<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Dashboard â€“ Param Sundari</title>

<style>
body {
    margin: 0;
    font-family: Poppins, sans-serif;
    background: #000;
    color: #fff;
}

/* NAVBAR */
nav {
    background: #111;
    padding: 15px;
    display: flex;
    gap: 20px;
    justify-content: center;
}
nav a {
    color: #ffb5c8;
    text-decoration: none;
    font-weight: bold;
}

/* SECTION BOX */
.section {
    background: #111;
    border: 1px solid #ffb5c8;
    margin: 20px;
    padding: 20px;
    border-radius: 12px;
}
.section h2 {
    color: #ffb5c8;
    margin-bottom: 10px;
}

/* INPUTS */
input, textarea, select {
    width: 95%;
    padding: 12px;
    margin: 8px 0;
    border-radius: 8px;
    border: 1px solid #ffb5c8;
    background: #000;
    color: #fff;
}

/* BUTTON */
button {
    background: #ffb5c8;
    border: none;
    padding: 12px 18px;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    margin-top: 10px;
}

/* TABLE */
table {
    width: 100%;
    text-align: left;
    border-collapse: collapse;
}
th, td {
    border-bottom: 1px solid #ffb5c8;
    padding: 10px;
}
th {
    color: #ffb5c8;
}
td img {
    width: 60px;
    height: 70px;
    object-fit: cover;
    border-radius: 6px;
}
.action-btn {
    background: red;
    padding: 6px 10px;
    border-radius: 6px;
    font-size: 12px;
}
</style>

</head>
<body>

<nav>
    <a href="admin-dashboard.html">Dashboard</a>
    <a href="index.html">View Website</a>
</nav>

<!-- ADD PRODUCT -->
<div class="section">
    <h2>Add New Product</h2>

    <input type="text" id="pname" placeholder="Product Name">
    <input type="number" id="pprice" placeholder="Price">
    <textarea id="pdesc" placeholder="Description"></textarea>
    
    <select id="ptop">
        <option value="false">Normal Product</option>
        <option value="true">Top Selling Product</option>
    </select>

    <input type="file" id="pimage">

    <button onclick="addProduct()">Add Product</button>
</div>

<!-- PRODUCT LIST -->
<div class="section">
    <h2>Products</h2>
    <div id="product-list">Loading...</div>
</div>

<!-- ORDER LIST -->
<div class="section">
    <h2>Orders</h2>
    <div id="order-list">Loading...</div>
</div>

<!-- REVIEWS LIST -->
<div class="section">
    <h2>Customer Reviews</h2>
    <div id="review-list">Loading...</div>
</div>

<script>
const backendURL = "https://backend-0slk.onrender.com";

/* ---------------------------
   ADD PRODUCT
---------------------------- */
async function addProduct() {
    let name = document.getElementById("pname").value;
    let price = document.getElementById("pprice").value;
    let desc = document.getElementById("pdesc").value;
    let topSelling = document.getElementById("ptop").value;
    let image = document.getElementById("pimage").files[0];

    if (!name || !price || !image) {
        alert("Name, price and image are required!");
        return;
    }

    let formData = new FormData();
    formData.append("name", name);
    formData.append("price", price);
    formData.append("description", desc);
    formData.append("topSelling", topSelling);
    formData.append("image", image);

    await fetch(`${backendURL}/api/products`, {
        method: "POST",
        body: formData
    });

    alert("Product Added!");
    loadProducts();
}

/* ---------------------------
   LOAD PRODUCTS
---------------------------- */
async function loadProducts() {
    let res = await fetch(`${backendURL}/api/products`);
    let data = await res.json();

    let html = `<table>
        <tr>
            <th>Image</th><th>Name</th><th>Price</th><th>Top</th><th>Action</th>
        </tr>`;

    data.forEach(p => {
        html += `
        <tr>
            <td><img src="${backendURL}${p.image}"></td>
            <td>${p.name}</td>
            <td>â‚¹${p.price}</td>
            <td>${p.topSelling ? "ðŸ”¥ Yes" : "No"}</td>
            <td>
                <button class="action-btn" onclick="deleteProduct(${p.id})">Delete</button>
            </td>
        </tr>`;
    });

    html += `</table>`;
    document.getElementById("product-list").innerHTML = html;
}
loadProducts();

/* DELETE PRODUCT */
async function deleteProduct(id) {
    if (!confirm("Delete this product?")) return;

    await fetch(`${backendURL}/api/products/${id}`, {
        method: "DELETE"
    });

    loadProducts();
}

/* ---------------------------
   LOAD ORDERS
---------------------------- */
async function loadOrders() {
    let res = await fetch(`${backendURL}/api/orders`);
    let orders = await res.json();

    let html = `<table>
        <tr>
            <th>Name</th><th>Phone</th><th>Total</th><th>Action</th>
        </tr>`;

    orders.forEach(o => {
        html += `
        <tr>
            <td>${o.name}</td>
            <td>${o.phone}</td>
            <td>â‚¹${o.total}</td>
            <td>
                <button class="action-btn" onclick="deleteOrder(${o.id})">Delete</button>
            </td>
        </tr>`;
    });

    html += `</table>`;
    document.getElementById("order-list").innerHTML = html;
}
loadOrders();

/* DELETE ORDER */
async function deleteOrder(id) {
    if (!confirm("Delete this order?")) return;

    await fetch(`${backendURL}/api/orders/${id}`, {
        method: "DELETE"
    });

    loadOrders();
}

/* ---------------------------
   LOAD REVIEWS
---------------------------- */
async function loadReviews() {
    let res = await fetch(`${backendURL}/api/reviews`);
    let reviews = await res.json();

    let html = `<table>
        <tr><th>Name</th><th>Review</th><th>Action</th></tr>`;

    reviews.forEach(r => {
        html += `
        <tr>
            <td>${r.name}</td>
            <td>${r.message}</td>
            <td>
                <button class="action-btn" onclick="deleteReview(${r.id})">Delete</button>
            </td>
        </tr>`;
    });

    html += `</table>`;
    document.getElementById("review-list").innerHTML = html;
}
loadReviews();

/* DELETE REVIEW */
async function deleteReview(id) {
    if (!confirm("Delete this review?")) return;

    await fetch(`${backendURL}/api/reviews/${id}`, {
        method: "DELETE"
    });

    loadReviews();
}
</script>

</body>
</html>
